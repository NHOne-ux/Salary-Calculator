<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Know Your Potential Salary</title>
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            display: flex;
            justify-content: center;
            align-items: flex-start;
            min-height: 100vh;
            margin: 20px 0;
            background: linear-gradient(135deg, #e0f7fa, #f0e6f5);
        }
        .calculator-container {
            width: 90%;
            max-width: 800px;
            padding: 20px;
            background: linear-gradient(135deg, #ffffff, #f9f9f9);
            border-radius: 15px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.2);
            border: 2px solid #ff9800;
        }
        .calculator-container h1 {
            text-align: center;
            color: #1e90ff;
            margin-bottom: 20px;
            font-size: 28px;
        }
        .month-panels {
            display: flex;
            justify-content: space-between;
            gap: 20px;
        }
        .month-panel {
            flex: 1;
            padding: 15px;
            background: #fff;
            border-radius: 10px;
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1);
            text-align: center;
            transition: transform 0.3s;
        }
        .month-panel:hover {
            transform: scale(1.02);
        }
        .month-panel h2 {
            color: #2c3e50;
            font-size: 20px;
            margin-bottom: 10px;
            background: linear-gradient(90deg, #ffeb3b, #ff9800);
            -webkit-background-clip: text;
            color: transparent;
        }
        .input-group {
            margin: 10px 0;
        }
        .input-group label {
            display: block;
            margin-bottom: 5px;
            font-weight: bold;
            color: #34495e;
            font-size: 14px;
        }
        .input-group input[type="text"] {
            width: 100%;
            padding: 8px;
            font-size: 14px;
            border: 2px solid #ddd;
            border-radius: 5px;
            box-sizing: border-box;
            background-color: #f8f8f8;
            transition: border-color 0.3s;
        }
        .input-group input[type="text"]:focus {
            border-color: #ff9800;
            outline: none;
        }
        .result {
            margin-top: 10px;
            padding: 8px;
            border-radius: 5px;
            font-weight: bold;
        }
        .result.green {
            color: #27ae60;
            background-color: #e8f5e9;
        }
        .surge-message {
            margin-top: 20px;
            text-align: center;
            font-size: 18px;
            color: #27ae60;
            white-space: nowrap;
        }
        .disclaimer {
            margin-top: 20px;
            text-align: center;
            font-size: 12px;
            color: #34495e;
        }
    </style>
</head>
<body>
    <div class="calculator-container">
        <h1>Know Your Potential Salary</h1>
        <div class="month-panels">
            <div class="month-panel">
                <h2>M1</h2>
                <div class="input-group">
                    <label for="m1Salary">Monthly Salary Offered (₹):</label>
                    <input type="text" id="m1Salary" oninput="formatSalary(this)" placeholder="Enter amount">
                </div>
                <div class="input-group">
                    <label for="m1Target">Target (₹):</label>
                    <input type="text" id="m1Target" oninput="formatSalary(this)" placeholder="Enter target">
                </div>
                <div class="input-group">
                    <label for="m1Achievement">Achievement (₹):</label>
                    <input type="text" id="m1Achievement" oninput="formatSalary(this); updateAll()" placeholder="Enter achievement">
                </div>
                <div class="result" id="m1GWPResult"></div>
            </div>
            <div class="month-panel">
                <h2>M2</h2>
                <div class="input-group">
                    <label for="m2Salary">Monthly Salary Offered (₹):</label>
                    <input type="text" id="m2Salary" oninput="formatSalary(this)" placeholder="Enter amount">
                </div>
                <div class="input-group">
                    <label for="m2Target">Target (₹):</label>
                    <input type="text" id="m2Target" oninput="formatSalary(this)" placeholder="Enter target">
                </div>
                <div class="input-group">
                    <label for="m2Achievement">Achievement (₹):</label>
                    <input type="text" id="m2Achievement" oninput="formatSalary(this); updateAll()" placeholder="Enter achievement">
                </div>
                <div class="result" id="m2GWPResult"></div>
            </div>
            <div class="month-panel">
                <h2>M3</h2>
                <div class="input-group">
                    <label for="m3Salary">Monthly Salary Offered (₹):</label>
                    <input type="text" id="m3Salary" oninput="formatSalary(this)" placeholder="Enter amount">
                </div>
                <div class="input-group">
                    <label for="m3Target">Target (₹):</label>
                    <input type="text" id="m3Target" oninput="formatSalary(this)" placeholder="Enter target">
                </div>
                <div class="input-group">
                    <label for="m3Achievement">Achievement (₹):</label>
                    <input type="text" id="m3Achievement" oninput="formatSalary(this); updateAll()" placeholder="Enter achievement">
                </div>
                <div class="result" id="m3GWPResult"></div>
            </div>
            <div class="month-panel">
                <h2>M4</h2>
                <div class="input-group">
                    <label for="m4Salary">Monthly Salary Offered (₹):</label>
                    <input type="text" id="m4Salary" oninput="formatSalary(this); updateAll()" placeholder="Enter amount">
                </div>
                <div class="input-group">
                    <label for="m4Target">Target (₹):</label>
                    <input type="text" id="m4Target" oninput="formatSalary(this); updateAll()" placeholder="Enter target">
                </div>
                <div class="input-group">
                    <label for="m4Achievement">Achievement (₹):</label>
                    <input type="text" id="m4Achievement" oninput="formatSalary(this); updateAll()" placeholder="Enter achievement">
                </div>
                <div class="result" id="m4GWPResult"></div>
                <div class="result green" id="m4SalaryResult"></div>
            </div>
        </div>
        <div class="surge-message" id="surgeMessage"></div>
        <div class="disclaimer">* For representation purpose only, actual payout may slightly vary.</div>
    </div>

    <script>
        function formatSalary(input) {
            let value = input.value.replace(/[^0-9]/g, '');
            let num = parseInt(value);
            input.value = num ? num.toLocaleString('en-IN') : '';
            updateAll();
        }

        function calculateGWP(target, achievement) {
            let gwp = 0;

            if (target > 0 && achievement > 0) {
                let ratio = (achievement / target) * 100;

                if (ratio < 60) {
                    gwp = 0;
                } else {
                    let base = target * 0.60; // 60% of target
                    let increment = target * 0.10; // 10% increments
                    let remainingAchievement = achievement - base; // Achievement beyond 60% base

                    let slabs = [
                        { min: 60, max: 69.9, rate: 0.03 },  // 3% for 60-69.9%
                        { min: 70, max: 79.9, rate: 0.04 },  // 4% for 70-79.9%
                        { min: 80, max: 89.9, rate: 0.05 },  // 5% for 80-89.9%
                        { min: 90, max: 99.9, rate: 0.06 },  // 6% for 90-99.9%
                        { min: 100, max: 109.9, rate: 0.12 }, // 12% for 100-109.9%
                        { min: 110, max: 119.9, rate: 0.15 }, // 15% for 110-119.9%
                        { min: 120, max: 129.9, rate: 0.20 }, // 20% for 120-129.9%
                        { min: 130, max: Infinity, rate: 0.25 } // 25% for 130% and above
                    ];

                    let currentBase = base;
                    for (let slab of slabs) {
                        if (ratio >= slab.min) {
                            if (ratio <= slab.max) {
                                // Within this slab, calculate proportional increment
                                let achievedInSlab = Math.min(achievement, currentBase + increment) - currentBase;
                                if (achievedInSlab > 0) {
                                    gwp += achievedInSlab * slab.rate;
                                }
                                break; // Stop at the slab containing the achieved ratio
                            } else {
                                // Full increment for this slab
                                gwp += increment * slab.rate;
                                currentBase += increment;
                            }
                        }
                    }

                    // Handle 130%+ slab if achievement exceeds 130%, starting from 140% to remove extra 2500
                    if (ratio >= 130) {
                        let excessStart = target * 1.40; // Start excess from 140% of target
                        let excessAchievement = Math.max(0, achievement - excessStart);
                        if (excessAchievement > 0) {
                            gwp += excessAchievement * 0.25;
                        }
                    }
                }
            }

            return Math.round(gwp); // Round to avoid decimal precision issues
        }

        function updateAll() {
            let m1Target = parseInt(document.getElementById('m1Target').value.replace(/,/g, '')) || 0;
            let m1Ach = parseInt(document.getElementById('m1Achievement').value.replace(/,/g, '')) || 0;
            let m2Target = parseInt(document.getElementById('m2Target').value.replace(/,/g, '')) || 0;
            let m2Ach = parseInt(document.getElementById('m2Achievement').value.replace(/,/g, '')) || 0;
            let m3Target = parseInt(document.getElementById('m3Target').value.replace(/,/g, '')) || 0;
            let m3Ach = parseInt(document.getElementById('m3Achievement').value.replace(/,/g, '')) || 0;
            let m4Salary = parseInt(document.getElementById('m4Salary').value.replace(/,/g, '')) || 0;
            let m4Target = parseInt(document.getElementById('m4Target').value.replace(/,/g, '')) || 0;
            let m4Ach = parseInt(document.getElementById('m4Achievement').value.replace(/,/g, '')) || 0;

            let m1GWP = calculateGWP(m1Target, m1Ach);
            let m2GWP = calculateGWP(m2Target, m2Ach);
            let m3GWP = calculateGWP(m3Target, m3Ach);
            let m4GWP = calculateGWP(m4Target, m4Ach);

            // Calculate achievement percentages
            let m1Ratio = m1Target > 0 ? (m1Ach / m1Target) * 100 : 0;
            let m2Ratio = m2Target > 0 ? (m2Ach / m2Target) * 100 : 0;
            let m3Ratio = m3Target > 0 ? (m3Ach / m3Target) * 100 : 0;
            let totalRatio = m1Ratio + m2Ratio + m3Ratio;
            let surgeBonus = totalRatio >= 450 ? 3750 : 0;

            // Display Potential Spark variable for each panel
            document.getElementById('m1GWPResult').className = 'result green';
            document.getElementById('m1GWPResult').innerText = `Your Potential Spark variable for the month: ₹${m1GWP.toLocaleString('en-IN')}`;
            document.getElementById('m2GWPResult').className = 'result green';
            document.getElementById('m2GWPResult').innerText = `Your Potential Spark variable for the month: ₹${m2GWP.toLocaleString('en-IN')}`;
            document.getElementById('m3GWPResult').className = 'result green';
            document.getElementById('m3GWPResult').innerText = `Your Potential Spark variable for the month: ₹${m3GWP.toLocaleString('en-IN')}`;
            document.getElementById('m4GWPResult').className = 'result green';
            document.getElementById('m4GWPResult').innerText = `Your Potential Spark variable for the month: ₹${m4GWP.toLocaleString('en-IN')}`;

            // Display SURGE bonus message only if criteria is met
            let surgeMessage = document.getElementById('surgeMessage');
            surgeMessage.innerText = totalRatio >= 450 ? "Congratulations! You have unlocked a monthly SURGE bonus of ₹3750*" : "";

            // Display total salary for M4 only if all M4 inputs are filled and surge criteria is met
            let m4SalaryResult = document.getElementById('m4SalaryResult');
            if (m4Salary > 0 && m4Target > 0 && m4Ach > 0 && totalRatio >= 450) {
                let totalM4Salary = m4Salary + m4GWP + surgeBonus;
                m4SalaryResult.innerText = `Your potential monthly salary for M4 is ₹${totalM4Salary.toLocaleString('en-IN')}`;
            } else {
                m4SalaryResult.innerText = '';
            }
        }
    </script>
</body>
</html>
